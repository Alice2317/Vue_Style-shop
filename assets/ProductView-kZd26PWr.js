import{c as B,a as T}from"./cartStore-TanCCHxI.js";import{l as R,s as q,u as E,k as I,r as _,o as U,a as m,b as z,c as D,e as l,d as t,w as f,t as r,F as j,g as F,n as A}from"./index-Sq6k6q8w.js";import{t as c,_ as G}from"./FooterComponent-czLGoVoS.js";import{_ as J}from"./HeaderComponent-PB81O0f2.js";import{_ as K}from"./autoplaySwiper-HmipjltQ.js";import"https://cdn.jsdelivr.net/npm/sweetalert2@11.10.6/+esm";const O={class:"container"},Q={class:"row align-items-center"},W={class:"col-md-6"},X=["src","alt"],Y={class:"col-md-6"},Z={"aria-label":"breadcrumb"},tt={class:"breadcrumb bg-white px-0 mb-0 py-3"},et={class:"breadcrumb-item"},st={class:"breadcrumb-item"},ot={class:"breadcrumb-item active","aria-current":"page"},at={class:"fw-bold h1 mb-1"},nt=["innerHTML"],lt=["innerHTML"],it={class:"mb-0 text-muted text-end"},rt={class:"h4 fw-bold text-end"},ct={class:"row align-items-center"},ut={class:"col-6"},dt={class:"input-group my-3 bg-light rounded"},pt={class:"input-group-prepend"},_t=t("i",{class:"fas fa-minus"},null,-1),mt=[_t],ft={class:"input-group-append"},ht=t("i",{class:"fas fa-plus"},null,-1),vt=[ht],bt=t("div",{class:"col-6"},[t("button",{type:"submit",class:"text-nowrap btn btn-dark w-100 py-2"}," 加入購物車 ")],-1),gt={class:"my-5"},Tt={__name:"ProductView",setup(yt){const L=R(),{isLoading:i}=q(L),h=E(),M=I(),N=B(),{getCarts:P}=N,s=_(null),v=_(null);function b(){i.value=!0;const o=`https://vue3-course-api.hexschool.io//v2/api/rongapi/product/${h.params.productId}`;T.get(o).then(e=>{if(e.data.success){s.value=e.data.product;const u=s.value.category.split(",").filter(d=>d.match(/[\u4e00-\u9fa5]/));v.value=u[0]}i.value=!1}).catch(e=>{c(!1,"失敗，請重新操作"),console.error("productView-getProduct出錯",e),i.value=!1})}U(()=>{b()});const a=_(1);function g(o){o?a.value>=10||a.value++:a.value<=1||a.value--}function S(o){i.value=!0,T.post("https://vue3-course-api.hexschool.io//v2/api/rongapi/cart",{data:{product_id:h.params.productId,qty:o.number}}).then(n=>{n.data.success?(c(!0,"成功加入購物車"),P()):c(!1,"失敗，請重新操作"),i.value=!1}).catch(n=>{c(!1,"失敗，請重新操作"),console.error("productView-postCart出錯",n),i.value=!1})}return M.afterEach((o,e)=>{o.fullPath!==e.fullPath&&(b(),a.value=1),window.scrollTo(0,0)}),(o,e)=>{var y,w,x,V,$,C,k;const n=m("router-link"),u=m("VField"),d=m("VForm");return z(),D(j,null,[l(J),t("main",O,[t("div",Q,[t("div",W,[t("img",{src:(y=s.value)==null?void 0:y.imageUrl,class:"img-fluid",alt:(w=s.value)==null?void 0:w.id},null,8,X)]),t("div",Y,[t("nav",Z,[t("ol",tt,[t("li",et,[l(n,{class:"text-muted",to:"/"},{default:f(()=>[F("回首頁")]),_:1})]),t("li",st,[l(n,{class:"text-muted",to:{name:"products"}},{default:f(()=>[F("全部")]),_:1})]),t("li",ot,r(v.value),1)])]),t("h2",at,r((x=s.value)==null?void 0:x.title),1),t("p",{innerHTML:(V=s.value)==null?void 0:V.description},null,8,nt),t("p",{class:"pb-6",innerHTML:($=s.value)==null?void 0:$.content},null,8,lt),t("p",it,[t("del",null,"NT $"+r((C=s.value)==null?void 0:C.origin_price),1)]),t("p",rt,"NT $"+r((k=s.value)==null?void 0:k.price),1),l(d,{onSubmit:S},{default:f(({errors:H})=>[t("div",ct,[t("div",ut,[t("div",dt,[t("div",pt,[t("button",{class:"btn btn-outline-dark border-0 py-2",type:"button",id:"button-addon1",onClick:e[0]||(e[0]=p=>g(!1))},mt)]),l(u,{name:"number",type:"text",class:A([{"is-invalid":H.number},"form-control border-0 text-center my-auto shadow-none bg-light"]),rules:"required|integer|between:1,10",modelValue:a.value,"onUpdate:modelValue":e[1]||(e[1]=p=>a.value=p)},null,8,["class","modelValue"]),t("div",ft,[t("button",{class:"btn btn-outline-dark border-0 py-2",type:"button",id:"button-addon2",onClick:e[2]||(e[2]=p=>g(!0))},vt)])])]),bt])]),_:1})])]),t("div",gt,[l(K)])]),l(G)],64)}}};export{Tt as default};
